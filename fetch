#!/bin/bash
root=`dirname $0`
cd "$root"
root=`pwd`
mkdir -p share/pcdev
cd share
echo Checking Aztec tools ...
if [ ! -d aztec34 ];then
    wget https://www.aztecmuseum.ca/az8634b.zip
    unzip -L az8634b.zip
    mv az8634b aztec34
    rm az8634b.zip
fi
echo Checking DR tools ...
if [ ! -f pcdev/linkcmd.exe -o ! -f pcdev/rasm86.exe -o ! -f pcdev/linkexe.exe \
   -o ! -f pcdev/lib86.exe ]; then
    mkdir -p pcdev
    mkdir -p tools
    cd tools
    wget http://www.cpm.z80.de/download/tools86.zip
    unzip -L tools86.zip
    unzip -L dos86pr2.zip
    cp linkcmd.exe rasm86.exe ../pcdev
    cp linkexe.exe ../pcdev
    cp lib86.exe ../pcdev
    cd ..;rm -rf tools
fi
echo Checking Microsoft tools ...
if [ ! -f pcdev/masm.exe -o ! -f pcdev/exe2bin.exe -o ! -f pcdev/link.exe ]; then
	mkdir -p pcdev
    cp ../sources/microsoft/*.exe pcdev
fi
if [ ! -f pcdev/asm.com -o ! -f pcdev/hex2bin.com ]; then
	mkdir -p pcdev
    cp ../sources/microsoft/*.com pcdev
fi
echo Checking CMD tools ...
if [ ! -f pcdev/cmdnfo.com -o ! -f pcdev/bin2com.com ]; then
	mkdir -p pcdev
    cp ../sources/cmdtools/*.com pcdev
fi
cd ..
echo Checking EMU2 ...
if [ ! -d emu2 ];then
    git clone https://github.com/dmsc/emu2
fi
if [ ! -f bin/emu2 ];then
    (cd emu2;make;cp emu2 ../bin)
fi
